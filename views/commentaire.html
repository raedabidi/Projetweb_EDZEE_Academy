<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="stylecomms.css">
    <link rel="stylesheet" href="stylelike.css"> <!-- Ajout du lien vers le fichier CSS pour les boutons like/dislike -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI/UX Comment Section Design </title>
</head>
<body>
    
    <div class="container">
        <div class="head"><h1>Post a Comment</h1></div>
        <div><span id="comment">0</span> Comments</div>
        <div class="text"><p>We are happy to hear from you</p></div>
        <div class="comments"></div>
        <div class="commentbox">
            <img src="../views/images/user.jpg" alt="">
            <div class="content">
                <h2>Comment as: </h2>
                <input type="text" value="Anonymous" class="user">

                <div class="commentinput">
                    <input type="text" placeholder="Enter comment" class="usercomment">
                    <div class="buttons">
                        <button type="submit" disabled id="publish">Publish</button>
                        <div class="notify">
                            <input type="checkbox" class="notifyinput"> <span>Notify me</span>
                        </div>
                    </div>
                </div>
                <p class="policy">This site is procted by reCAPTCHA and the Google <a href="">privacy policy</a> and <a href="">Terms of Service</a> apply.</p>
            </div>
        </div>
    </div>

<script>
const USERID = {
    name: null,
    identity: null,
    image: null,
    message: null,
    date: null
}

const userComment = document.querySelector(".usercomment");
const publishBtn = document.querySelector("#publish");
const comments = document.querySelector(".comments");
const userName = document.querySelector(".user");
const notify = document.querySelector(".notifyinput");

// Liste de mots à censurer
const badWords = ["dumb", "stupid", "fuck"];

// Fonction pour censurer les gros mots dans un commentaire
function censorBadWords(comment) {
    return comment.replace(new RegExp(badWords.join("|"), "gi"), match => "*".repeat(match.length));
}

userComment.addEventListener("input", e => {
    if (!userComment.value) {
        publishBtn.setAttribute("disabled", "disabled");
        publishBtn.classList.remove("abled")
    } else {
        publishBtn.removeAttribute("disabled");
        publishBtn.classList.add("abled")
    }
})

function addPost() {
    if (!userComment.value) return;
    USERID.name = userName.value;
    if (USERID.name === "Anonymous") {
        USERID.identity = false;
        USERID.image = "user.jpg"
    } else {
        USERID.identity = true;
        USERID.image = "user.jpg"
    }

    USERID.message = censorBadWords(userComment.value); // Appliquer la censure des gros mots
    USERID.date = new Date().toLocaleString();
    let published =
        `<div class="parents">
            <img src="${USERID.image}">
            <div>
                <h1>${USERID.name}</h1>
                <p>${USERID.message}</p>
                <div class="engagements">
                    <img src="like.png" class="like-btn" onclick="likeComment(this)">
                    <span class="like-count">0</span> <!-- Ajout d'un élément pour afficher le nombre de likes -->
                    <img src="dislike.png" class="dislike-btn" onclick="dislikeComment(this)">
                    <span class="dislike-count">0</span> <!-- Ajout d'un élément pour afficher le nombre de dislikes -->
                </div>
                <span class="date">${USERID.date}</span>
            </div>    
        </div>`

    comments.innerHTML += published;
    userComment.value = "";
    publishBtn.classList.remove("abled")

    let commentsNum = document.querySelectorAll(".parents").length;
    document.getElementById("comment").textContent = commentsNum;

}

publishBtn.addEventListener("click", addPost);

// Fonction pour gérer l'action de like sur un commentaire
function likeComment(element) {
    let parent = element.closest(".parents");
    let likeCount = parent.querySelector(".like-count");
    let currentCount = parseInt(likeCount.textContent);
    likeCount.textContent = currentCount + 1;
}

// Fonction pour gérer l'action de dislike sur un commentaire
function dislikeComment(element) {
    let parent = element.closest(".parents");
    let dislikeCount = parent.querySelector(".dislike-count");
    let currentCount = parseInt(dislikeCount.textContent);
    dislikeCount.textContent = currentCount + 1;
}

</script>

</body>
</html>
